### 简介
以实现基于cortex-m3架构的实时操作系统为最终目标。目前已实现：
- 进程抢占式切换
- 堆区内存的分配与回收
- 自旋锁
### 使用指南
~~除了我本人应该没有其他人用吧~~
#### 进程
使用固定大小的数组管理进程，而非链表。每个进程的栈区大小固定，事先确定支持的最大进程数量，且所有进程共享堆区。
- 创建进程
    ```c
    void create_task(void (*entry)());
    ```
    传递需要执行的函数地址即可。
- 暂时不考虑进程的销毁。
- 进程的调度使用最简单的轮转调度。
#### 堆区
需要指定堆区大小，一般而言内存容量偏小，没有分页的必要。
- 申请堆区内存
    ```c
    void *malloc(uint32_t size);
    ```
- 释放堆区内存
    ```c
    void free(void *pointer);
    ```
#### 自旋锁
cortex-m3的自旋锁实现方式比较另类，并非是一个原子操作，具体实现不展开讨论。
- 上锁
    ```c
    void _spin_lock(Lock *lock);
    ```
- 解锁
    ```c
    void _spin_unlock(Lock *lock);
    ```
- 其中需要上锁的变量必须经过**volatile**关键字修饰，且必须符合内存地址字对齐。
    ```c
    typedef uint32_t volatile Lock;
    ```
### 注意事项
- 代码未经过严格测试！！！没有在真实的硬件上测试！！！
- 代码风格不遵守规范！！！阅读期间需谨防血压升高！！！
### 碎碎念
创建该仓库的初衷是记录学习历程，踩过不少坑，本应该总结这些经验教训给后来者参考，但是平时太懒没记录，以后有空补上...
